{{ $related := first 4 ( where ( where .Site.Pages.ByDate.Reverse ".Params.tags" "intersect" .Params.tags ) "Permalink" "!=" .Permalink ) }}
{{ with $related }}
<!-- begin related-posts -->
<section class="section related-posts">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="section__inner">

          <div class="section__info">
            <div class="section__head">
              <h2 class="section__title">Related</h2>
              {{ range first 1 ($.GetTerms "tags") }}
                <a href="{{ .Permalink }}" class="section__link">See all<span> {{ .LinkTitle }}</span></a>
              {{ end }}
            </div>
          </div>

          <div class="row">
            {{ range . }}
            <div class="col col-3 col-w-6 col-t-12">
              {{ partial "article.html" (dict "context" .) }}
            </div>
            {{ end }}
          </div>

        </div>
      </div>
    </div>
  </div>
</section>
<!-- end related-posts -->
{{ end }}